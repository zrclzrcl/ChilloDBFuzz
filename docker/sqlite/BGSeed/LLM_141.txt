CREATE TABLE products (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    description TEXT,
    price REAL NOT NULL CHECK (price > 0),
    created_at DATETIME DEFAULT (strftime('%Y-%m-%d %H:%M:%S', 'now'))
);

CREATE INDEX idx_products_name ON products (name);

CREATE TRIGGER update_price_trigger
BEFORE UPDATE ON products
FOR EACH ROW
BEGIN
    SELECT CASE
        WHEN NEW.price < OLD.price * 0.8 THEN
            RAISE(FAIL, 'Price decrease exceeds 20%')
    END;
END;

INSERT INTO products (name, description, price) VALUES ('Example Product', 'A test product', 10.00);
INSERT INTO products (name, price) VALUES ('Another Product', 25.50);

UPDATE products SET description = 'Updated description' WHERE id = 1;

DELETE FROM products WHERE price > 100;

SELECT * FROM products WHERE price BETWEEN 5 AND 30;

PRAGMA integrity_check;