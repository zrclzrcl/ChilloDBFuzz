CREATE TABLE products (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    name TEXT NOT NULL,
    description TEXT,
    price REAL NOT NULL CHECK (price > 0),
    category TEXT DEFAULT 'uncategorized'
);

CREATE INDEX idx_products_name ON products (name);

CREATE VIEW discounted_products AS
SELECT id, name, price * 0.9 AS discounted_price
FROM products
WHERE price > 100;

INSERT INTO products (name, description, price, category) VALUES
('Awesome Widget', 'A really great widget', 125.50, 'widgets'),
('Basic Widget', 'A simple widget', 25.00, 'widgets'),
('Deluxe Gadget', 'The ultimate gadget', 250.00, 'gadgets');

CREATE TRIGGER update_description
AFTER INSERT ON products
BEGIN
    UPDATE products SET description = 'New product added' WHERE id = NEW.id AND description IS NULL;
END;

CREATE TABLE product_images (
    product_id INTEGER,
    image_url TEXT,
    FOREIGN KEY (product_id) REFERENCES products(id)
);

INSERT INTO product_images (product_id, image_url) VALUES
(1, 'http://example.com/widget.jpg'),
(2, 'http://example.com/basic_widget.jpg');

PRAGMA table_info(products);
PRAGMA index_list(products);
PRAGMA foreign_key_list(product_images);