CREATE TABLE employees (
    employee_id INTEGER PRIMARY KEY,
    first_name TEXT NOT NULL,
    last_name TEXT NOT NULL,
    hire_date DATE,
    salary REAL
);

CREATE TABLE departments (
    department_id INTEGER PRIMARY KEY,
    department_name TEXT NOT NULL,
    location TEXT
);

CREATE TABLE employee_details (
    employee_id INTEGER PRIMARY KEY,
    address TEXT,
    phone_number TEXT,
    FOREIGN KEY (employee_id) REFERENCES employees(employee_id)
);

INSERT INTO departments (department_name, location) VALUES ('Sales', 'New York');
INSERT INTO departments (department_name, location) VALUES ('Marketing', 'London');
INSERT INTO departments (department_name, location) VALUES ('IT', 'San Francisco');

INSERT INTO employees (first_name, last_name, hire_date, salary) VALUES ('John', 'Doe', '2022-01-15', 60000);
INSERT INTO employees (first_name, last_name, hire_date, salary) VALUES ('Jane', 'Smith', '2023-03-20', 75000);
INSERT INTO employees (first_name, last_name, hire_date, salary) VALUES ('Peter', 'Jones', '2023-08-01', 80000);

INSERT INTO employee_details (employee_id, address, phone_number) VALUES (1, '123 Main St', '555-1234');
INSERT INTO employee_details (employee_id, address, phone_number) VALUES (2, '456 Oak Ave', '555-5678');
INSERT INTO employee_details (employee_id, address, phone_number) VALUES (3, '789 Pine Ln', '555-9012');

SELECT e.first_name, e.last_name, d.department_name
FROM employees e
JOIN departments d ON d.department_id = (SELECT department_id FROM departments ORDER BY department_id LIMIT 1)
WHERE e.salary > 70000
ORDER BY e.last_name;

SELECT sum(length(address)) from employee_details;

SELECT date('now');
SELECT date('now','start of month','+1 month','-1 day');

SELECT substr('hello',1,3);
SELECT instr('hello','l');

SELECT typeof(1);
SELECT typeof('abc');
SELECT typeof(1.1);
SELECT typeof(NULL);